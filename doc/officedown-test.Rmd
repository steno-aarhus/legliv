---
date: "`r Sys.Date()`"
author:
  - Niels Bock^[Department of Public Health, Aarhus university, Aarhus, Denmark]
  - Fie Langmann^[Department of Public Health, Aarhus university, Aarhus, Denmark]
  - Christina C. Dahm^[Department of Public Health, Aarhus university, Aarhus, Denmark]
title: "Substitution of red meat with legumes and risk of primary liver cancer in `r nrow(data)` UK Biobank participants: a prospective cohort study"
output: 
  officedown::rdocx_document:
    mapstyles:
      Normal: ['First Paragraph']
csl: the-american-journal-of-clinical-nutrition.csl
bibliography: references.bib
---

```{r setup officedown, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.cap = TRUE)
library(officedown)
library(officer)

fp <- fp_par(
  text.align = "center", 
  padding.bottom = 20, padding.top = 120, 
  border.bottom = fp_border())

ft <- fp_text(shading.color='#EFEFEF', bold = TRUE)
```

```{r setup main, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
targets::tar_config_set(store = here::here("_targets"))
data <- targets::tar_read(data_main)
data_flowchart <- targets::tar_read(data_flowchart)
```

```{r setup secondary, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
targets::tar_config_set(store = here::here("_targets"))
data_hcc <- targets::tar_read(data_with_hcc)
data_icc <- targets::tar_read(data_with_icc)
```

```{r setup sens, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
targets::tar_config_set(store = here::here("_targets"))
data_alc <- targets::tar_read(data_with_alc)
data_misreporter <- targets::tar_read(data_with_misreporter)
data_3_ques_comp <- targets::tar_read(data_with_3_ques_comp)
data_liver_disease <- targets::tar_read(data_without_liver_disease)
data_death <- targets::tar_read(data_with_death)
```

```{r packages, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(here)
library(gt)
library(gtsummary)
library(tidyverse)
library(survival)
library(ggconsort)
library(scales)
library(ggdag)
```

```{r source base tables, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source(here("R","2-table1.R"))
source(here("R","4-diet-table.R"))
```

```{r source main table and quintile, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source(here("R","3-1-main-analysis-table.R"))
source(here("R","7-table-legume-quintile.R"))
```

```{r source cancer type, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source(here("R","6-table-cancer-type.R"))
```

```{r source sens, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source(here("R", "sens-table.R"))
```

\newpage

# Abstract

Objective:

Research Design and Methods:

Results:

Conclusions:

# Introduction

The main aim of this study was to estimate the effect of substituting
unprocessed red meat, processed red meat and total red meat with legumes
on primary liver cancer in a free-living population.

# Research Design and Methods

**Study population**

The UK Biobank, a population-based prospective cohort, was initiated in
2006. [@sudlow2015] During 2006-2010, more than 500,000 participants,
aged 40-69, were recruited and visited designated assessment centres
across the UK Participants provided information about age, sex,
sociodemographic factors (education, Townsend deprivation index, living
alone) and lifestyle factors (smoking, alcohol consumption, physical
activity) via touch screen questionnaires and computer-assisted
interviews. Anthropometric data (BMI, waist circumference) were
collected via physical measurements (reference to UKB document here).

**Dietary assessment**

A web-based 24-hour dietary recall was administered at the end of the
initial assessment visit for the last 70,000 recruited participants
(reference from UKB document here). From February 2011 to April 2012,
320,000 participants who had provided an e-mail address were invited on
four separate occasions to complete the 24-hour dietary recall, the
Oxford WebQ, of which 210,947 participants completed at least one. The
Oxford WebQ covered 206 food items and 32 beverage items commonly
consumed in the UK. Intakes were reported in standard units of
measurements, e.g., servings, cups, slices, etc. with intake categories
ranging from 0 to 3+ units [@piernas2021]. The Oxford WebQ has been
validated againts interviewer-based 24-hour dietary recalls and
biomarkers [@Liu2011; @Greenwood2019].

Researchers defined79 food groups and 14 beverage groups from the Oxford
WebQ using the UK National Diet and Nutrition Survey categories
[@piernas2021]. These food and beverage groups were used when defining
the food groups used in the substitution analyses (Supplementary Table
1). Legumes were defined as dietary pulses, baked beans, tofu-based
products, peas, hummus, soy drinks, and soy-based desserts and yogurt.
Red meat intake was defined as intake of beef, pork, lamb, or other
meat, including offal. Processed meat intake was defined as sausages,
bacon (with and without fat), ham, or liver pate. Other food groups
included were animal-based foods, unhealthy plant-based foods, healthy
plant-based foods, and alcoholic beverages (Supplementary Table 1).
Animal-based and healthy and unhealthy plant-based food foods were
grouped based on plant-based diet indices from previous studies
[@Thompson2023; @Heianza2021; @Satija2017; @Satija2016]. An overview of
included foods in each food group is displayed in Supplementary Table 1.

Due to the incapability of a single 24-hour dietary recall to properly
assess habitual dietary intake and variation in diet over time
[@thompson2013; @gurinovic2017], only participants who completed two or
more Oxford WebQs were eligible for inclusion in this study.

**Liver cancer assessment**

Liver cancer was defined according to ICD-10 diagnosis codes C22.0 for
Hepatocellular carcinoma (HCC) or C22.1 for Intrahepatic
cholangiocarcinoma (ICC). Incident and prevalent cases of liver cancer
and corresponding diagnosis dates were obtained via linkage to central
cancer registries or hospital inpatient episodes [@sudlow2015].

**Assessment of confounders**

Confounders were defined *a priori* from a literature review of the
background literature and illustrated using directed acyclic graphs
(Supplementary Figure 1). The following confounding variables were
selected: age at baseline (years, continuous), sex (male, female),
educational level (high: College or University degree, intermediate: A
levels/AS levels, O levels/GCSEs, or equivalent, low: none of the
previous mentioned), Townsend Deprivation Index (continuous), Living
alone (yes, no), waist circumference (cm, continuous), physical activity
(above/below the 2017 UK Physical activity guidelines of 150 minutes of
moderate activity per week or 75 minutes of vigorous activity, or
unknown), smoking (pack years as a proportion of lifespan exposed to
smoking, continous), and alcohol intake (g/day, continuous). All
confounders except age were selected from the initial assessment visit
before the start of follow-up.

**The substitution model**

The substitution analyses were conducted by replacing an equal mass of
meat with legumes. The size of the substitution was set to 15 g of
legumes for 15 g of meat to keep the substitution size below the mean
intake of any of the substituted food groups in the cohort. The
substitutions were modelled using the leave-one-out-approach in which
variables for every food group along with a variable for total food
intake are included, except the food group that are to be substituted
[@Ibsen2021]. To estimate substitution of 15 g of all red meats (red and
processed) with 15 g of legumes, the following model was defined:

$$
log(h(t;x)) = log(h(0;t)) + \beta_1 Legumes (15g) + \beta_2 Total food intake (g) + \beta_3 Other food groups(g) + \beta_4 Covariates
$$

When substituting only red meat with legumes, processed meat was added
to the model:

$$
log(h(t;x)) = log(h(0;t)) + \beta_1 Legumes (15g) + \beta_2 Processed meat (15g) + \beta_3 Total food intake (g) + \beta_4 Other food groups(g) + \beta_5 Covariates
$$

When substituting only processed meat with legumes, red meat was added
to the model:

$$
log(h(t;x)) = log(h(0;t)) + \beta_1 Legumes (15g) + \beta_2 Red meat (15g) + \beta_3 Total food intake (g) + \beta_4 Other food groups(g) + \beta_5 Covariates
$$

**Statistical analysis**

Multivariable-adjusted Cox proportional hazards regression models were
used to estimate hazard ratios (HR) with corresponding 95% confidence
intervals (CI) with age as the underlying timescale. Participants were
followed from the date of their last completed Oxford WebQ until the
occurrence of the event of interest or due to right censoring, whichever
came first. Participants were right censored in the event of death, loss
to follow-up, or administrative end of follow-up (January 31, 2022). Two
levels of adjustments were added to the substitution model. Model 1 was
minimally adjusted for age, total weight of food intake, and all other
food groups to fit the substitution model. Model was further adjusted
for sex, educational level, Townsend Deprivation Index, living alone,
physical activity, smoking, alcohol intake, and waist circumference.

In secondary analyses, each cancer type was analysed separately to
evaluate if the pooling of HCC and ICC as one outcome in the main
analysis was justified. Furthermore, to estimate the effect of legume
intake regardsless of other dietary components, legume consumers
(divided into quartiles) were compared to non-consumers in secondary
analyses.

To evaluate the robustness of the main analyses, sensitivity analyses
were performed on subsamples of participants by excluding those with
high alcohol intake (more than 32 grams per day for men and 24 grams per
day for women), participants with plausible energy intake misreporting
(≤ 3200 or ≥ 16800 kJ/day for men and ≤ 2000 or ≥ 14000 kJ/day for
women), participants with any other liver disease before baseline, and
participants with any type of cancer before baseline.

Furthermore, sensitivity analyses were conducted by including only those
with ≥3 completed Oxford WebQs.

3.       (Mangler)

Sensitivity analyses were modelled like the main analyses.

All analyses were conducted in R (version) with a significance level of
5 %.

# Results

After excluding participants with liver cancer and participants lost to
follow-up before baseline, 126,744 participants remained who had
completed two or more diet questionnaires. During a median follow-up
time of 11.3 years, 173 participants developed liver cancer.
Participants who developed liver cancer were older at baseline, had a
higher waist circumference, were less physically active, fewer had never
smoked, and more were male, compared to all included participants (Table
1).

Mean daily energy intake and food intake and median daily intake of all
specified food groups are presented in table 2.

No association was found for substituting 15 g/day of legumes with 15
g/day of total meat, red meat, or processed meat and risk of primary
liver cancer in model 1 (Table \@ref(tab:maintable): total meat:
`r inline_text(m1t, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
red meat:
`r inline_text(m1r, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
processed meat:
`r inline_text(m1p, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`).
The estimated associations changed minimally but remained
non-significant with further adjustments (Table \@ref(tab:maintable):
total meat:
`r inline_text(m2t, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
red meat:
`r inline_text(m2r, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
processed meat:
`r inline_text(m2p, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`).

In secondary analyses, when analyzing the substitution association for
HCC and ICC separately, the risk of HCC was positively associated with
substituting total, red, or processed meat with legumes (Supplementary
Table 2, total meat:
`r inline_text(m2t_hcc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
red meat:
`r inline_text(m2r_hcc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
processed meat:
`r inline_text(m2p_hcc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`).
The association between substituting total, red, or processed meat with
legumes and ICC indicated inverse associations (Supplementary Table 2,
total meat:
`r inline_text(m2t_icc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
red meat:
`r inline_text(m2r_icc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`;
processed meat:
`r inline_text(m2p_icc, variable = legume_daily_15, pattern = '{estimate} (95% {ci})')`).
The magnitude or direction of associations were not significantly
different across strata of liver cancer types.

In the adjusted non-substitution analysis, a mean intake of 6.3 grams of
legumes per day was associated with a reduced risk of liver cancer,
compared to no intake
(`r inline_text(m2t_leg, variable = legume_category, level = "Q1", pattern = '{estimate} (95% {ci})')`);
however, no associations were observed with further increase in legume
intake (supplementary table 6).

In sensitivity analyses, excluding participants with high alcohol intake
or participants with plausible energy intake misreporting or setting
inclusion criteria to ≥ 3 completed diet questionnaires did not alter
the estimates in any statistically significant way (supplementary tables
3 to 5).

# Discussion

## Summary of results

## Strength and limitations

Selection bias: Incomplete registries regarding cancer. Participants who
completed \>= 2 diet questionnaires are healthier than the those who
didn't?

Lavt bortfald.

kun 5% deltagelse.

Information bias: Underreporting of unhealthy habits? Non-differentiated
misclassification. Participants with unhealthy habits are
underreporting? differentiated misclassification.

incomplete registries, information problem.

Confounding

residual confounding: broad food groups erase effect of specific foods.
Are processed meat eaten with legumes in the UK? (baked beans and
bacon). Aflatoxins

Few events: trade off between statistical validity and residual
confounding.

## Other studies: substitution analyses and foods related to disease

Discuss studies on legumes/red meat and liver cancer/other diseases.
Other substitutions

## Discuss results

e.g, why estimates for HCC and ICC go in opposite direction. sensitivity
analyses

## Perspectives

# Conclusions

# Acknowledgements

# References

::: {#refs}
:::

\newpage

# Tables

```{r tab.cap="Table 1", tab.id="table1"}
table_one
```

\newpage

```{r tab.cap="Table 2", tab.id="table2"}
diet_table
```

\newpage

```{r tab.cap="Table 3", tab.id="maintable", tab.cap.style = "Table Caption", echo=FALSE}
table_main
```

\newpage

```{r fig.width= 5.3, fig.height= 6, fig.cap="Figure 1. Flowchart of included participants."}
knitr::opts_chunk$set(dpi = 300)
source(here("R", "flowchart.R"))
flowchart
```

\newpage

# Supplemental Material

```{r fig.width= 5.3, fig.height= 6, fig.cap="Supplementary figure 1. Directed acyclic graph (DAG) visualizing the hypothesised causal relationship between replacing meat with legumes and liver cancer based on assumptions of biasing paths. Red nodes represent confounders. Square nodes represent the minimal sufficient adjustment set for estimating the effect of replacing meat with legumes on liver cancer. Shadowed arrows represent biasing paths."}
knitr::opts_chunk$set(dpi = 300)
source(here("R", "dag-code.R"))
dag
```

\newpage

```{r tab.cap="Table 4", tab.id="table4"}
source(here("R", "food-group-table.R"))
food_group_table
```

\newpage

```{r tab.cap="Table 5", tab.id="table5"}
table_cancer_type
```

\newpage

```{r tab.cap="Table 6", tab.id="table6", echo=FALSE}
table_legume
```

\newpage

<!---BLOCK_LANDSCAPE_START--->

```{r tab.cap="Table 7", tab.id="table7", echo=FALSE}
table_sens
```

<!---BLOCK_LANDSCAPE_STOP--->
